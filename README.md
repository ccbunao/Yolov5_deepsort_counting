
# yolov5-deepsort-OSnet



## 1.Introduction

This repository contains a highly configurable object countable two-stage-tracker that can be configured according to the deployment environment and counts object based on the results of the tracker.   The detections generated by [YOLOv5](https://github.com/ultralytics/yolov5), a family of object detection architectures and models pretrained on the COCO dataset, are passed to a [Deep Sort algorithm](https://github.com/ZQPei/deep_sort_pytorch) which combines motion and appearance information based on [OSNet](https://github.com/KaiyangZhou/deep-person-reid) in order to tracks the objects. It can track any object that your Yolov5 model was trained to detect.Object counting was added because it generates a unique ID for each object tracked so that it can count objects.  Our code will be made available athttps://github.com/ccbunao/Yolov5_deepsort_counting.git or https://gitee.com/Zhangwencong/yolov5_deepsort_counting.git

## 2.Related Work

## 3.Revisiting the detection and tracking

## 4.Before you run the tracker

1. Clone the repository recursively:

2. Make sure that you fulfill all the requirements:

   `pip install -r requirements.txt`

## 5.Tracking sources

### Tracking can be run on video formats

```bash
python track.py --source 0  # webcam
                           img.jpg  # image
                           vid.mp4  # video
                           path/  # directory
                           path/*.jpg  # glob
                           'https://youtu.be/Zgi9g1ksQHc'  # YouTube
                           'rtsp://example.com/media.mp4'  # RTSP, RTMP, HTTP stream
```

### Select object detection and ReId model

#### Yolov5

There is a clear trade-off between model inference speed and accuracy. In order to make it possible to fulfill your inference speed/accuracy needs you can select a Yolov5 family model for automatic download

```bash
$ python track.py --source 0 --yolo_model yolov5n.pt --img 640
                                          yolov5s.pt
                                          yolov5m.pt
                                          yolov5l.pt 
                                          yolov5x.pt --img 1280
                                          ...
```

#### Deepsort

The above applies to DeepSort models as well. Choose a ReID model based on your needs from this ReID [model zoo](https://kaiyangzhou.github.io/deep-person-reid/MODEL_ZOO)

```bash
$ python track.py --source 0 --deep_sort_model osnet_x0_25_market1501
```

### Filter tracked classes

By default the tracker tracks all MS COCO classes.

If you want to track a subset of the MS COCO classes, add their corresponding index after the classes flag

[Here](https://tech.amikelive.com/node-718/what-object-categories-labels-are-in-coco-dataset/) is a list of all the possible objects that a Yolov5 model trained on MS COCO can detect. Notice that the indexing for the classes in this repo starts at zero.

### MOT compliant results

Can be saved to your experiment folder `runs/track/<yolo_model>_<deep_sort_model>/` by

```bash
python3 track.py --source ... --save-txt
```